<?xml version="1.0" encoding="utf-8"?>
<X3D profile='Full' version='3.2'>
  <head>
    <meta name='title' content='SoftBodyAngularJoint_Rigid.x3d'/>
    <meta name='description' content='Example of a angular joint between a soft body and a rigid body.'/>
    <meta name='author' content='SenseGraphics AB, 2006-2019'/>
  </head>

  <Scene>
    <!-- Import physics library -->
    <ImportLibrary url='"../../bin32/H3DPhysics" "../../../bin32/H3DPhysics" "../../bin64/H3DPhysics" "../../../bin64/H3DPhysics" "H3DPhysics" "libh3dphysics.so" "libh3dphysics.dylib"' />

    <GlobalSettings>
      <!-- These options are required to keep the frame rate up when changing the geometry -->
      <HapticsOptions useBoundTree='false'
              maxDistance='0.005'
              lookAheadFactor='0.01' />
    </GlobalSettings>

    <!-- Python script to set up ruspini renderer and other options -->
    <!-- The Ruspini renderer is required to help prevent fall through on changing geometries -->
    <PythonScript DEF='PS' url='SoftBody.py' />

    <IMPORT inlineDEF='H3D_EXPORTS' exportedDEF='HDEV' AS='HDEV' />
    <Viewpoint DEF='V' position='0 0 0.6' />
    <DirectionalLight direction='0 -1 0' intensity='0.5' />

    <Transform DEF='T'>
      <Shape DEF='S'>
        <Appearance>
          <Material diffuseColor='0.5 0.9 0.9' />
          <FrictionalSurface stiffness='0.3' />
        </Appearance>
        <Box DEF='G' size='1 0.5 1' />
      </Shape>
    </Transform>

    <Transform DEF='T1'>
      <Shape DEF='S1'>
        <Appearance>
          <Material diffuseColor='1 0.5 0.5' />
          <FrictionalSurface stiffness='0.3' />
        </Appearance>
        <Box DEF='G1' size='0.05 0.05 0.05' />
      </Shape>
    </Transform>

    <Shape>
      <Appearance>
        <Material diffuseColor='0.5 0.5 1' />
        <FrictionalSurface stiffness='0.3' />
      </Appearance>
      <IndexedTriangleSet DEF="Body1_Surface" index='1 0 15 14 0 12 12 0 3 12 3 2 13 12 2 4 11 2 4 8 7 7 11 4 10 11 7 9 10 7 11 13 2 5 8 4 6 8 5 15 0 14 17 1 16 16 1 15 10 22 11 10 19 22 22 19 18 18 20 21 18 21 23 23 22 18 9 19 10 24 19 9 166 19 24 166 25 18 18 25 26 26 20 18 166 24 25 18 19 166 7 24 9 168 24 7 31 25 168 26 25 31 8 168 7 8 167 168 167 27 30 30 27 29 6 28 8 8 28 167 28 27 167 167 30 168 168 30 31 25 24 168 5 32 6 32 28 6 169 28 32 33 27 169 29 27 33 34 29 33 169 32 33 169 27 28 171 32 5 171 36 170 36 35 170 35 33 170 34 33 37 37 33 35 4 171 5 4 36 171 33 32 170 170 32 171 172 36 4 173 172 178 178 42 41 178 41 173 173 41 40 174 173 40 176 174 175 45 46 175 175 46 176 46 37 176 37 35 176 173 35 36 173 36 172 2 3 177 177 3 43 3 0 43 42 177 43 178 177 42 172 177 178 2 177 172 2 172 4 39 174 40 175 174 39 175 39 38 44 45 38 38 45 175 176 35 173 176 173 174 179 55 48 179 49 180 49 50 180 50 51 180 180 51 44 44 54 180 54 55 180 180 55 179 179 48 47 47 49 179 51 53 44 44 53 45 53 52 45 52 21 46 37 21 30 30 29 34 37 30 34 52 46 45 30 21 31 21 20 31 31 20 26 46 21 37 14 12 56 56 12 183 187 184 183 187 181 185 182 181 189 190 188 189 190 61 60 60 188 190 125 221 220 59 182 188 188 182 189 183 12 13 186 183 13 186 22 187 181 22 23 23 21 189 189 21 52 189 52 190 190 52 53 53 61 190 51 61 53 11 186 13 11 22 186 187 22 181 181 23 189 59 58 182 182 58 185 185 181 182 58 184 185 185 184 187 57 184 58 56 184 57 183 184 56 187 183 186 15 14 62 62 14 56 57 63 56 58 64 57 65 58 59 121 220 219 61 67 60 50 61 51 50 67 61 56 63 62 57 64 63 65 64 58 217 218 60 60 67 66 15 113 16 15 112 113 15 111 112 15 195 111 195 106 109 109 106 110 106 105 110 110 105 107 110 107 108 62 195 15 62 104 195 195 104 106 62 103 104 63 103 62 63 101 102 63 102 103 64 193 63 93 193 64 93 64 92 92 64 91 91 64 191 191 64 65 191 65 194 83 84 194 194 84 191 84 86 191 86 89 191 89 91 191 65 66 194 66 82 194 82 83 194 66 67 196 67 74 196 73 74 67 72 73 67 71 72 67 50 71 67 49 71 50 49 70 69 69 71 49 47 70 49 68 70 47 74 76 196 196 76 75 78 80 75 77 78 75 75 80 196 196 80 79 79 81 196 196 81 66 81 82 66 86 90 89 85 90 86 88 90 85 87 88 85 94 193 93 192 193 94 192 101 63 63 193 192 96 192 94 96 197 192 100 99 197 197 99 192 192 99 101 95 197 96 97 197 95 97 98 197 197 98 100 111 195 109 43 0 1 43 1 119 119 118 42 118 117 41 40 117 116 116 115 39 115 114 38 44 114 54 38 114 44 43 119 42 42 118 41 41 117 40 40 116 39 39 115 38 48 120 47 120 68 47 199 225 224 198 120 122 198 122 123 198 222 219 69 70 198 198 70 68 198 68 120 199 74 73 219 220 199 71 223 219 199 224 219 199 124 126 126 74 199 200 76 74 200 77 75 75 76 200 200 74 126 200 126 127 200 127 128 200 128 129 129 77 200 130 77 129 130 78 77 133 131 201 201 130 132 201 132 133 131 81 201 201 81 79 79 80 201 201 80 78 201 78 130 202 82 81 202 84 83 202 83 82 202 81 131 202 131 135 135 134 202 202 134 136 136 84 202 203 86 84 203 87 85 85 86 203 203 84 136 203 136 137 203 137 138 203 138 139 139 87 203 140 87 139 140 88 87 143 141 204 204 140 142 204 142 143 141 91 204 204 91 89 89 90 204 204 90 88 204 88 140 145 91 141 145 92 91 144 93 92 146 93 144 146 94 93 144 92 145 96 94 205 205 97 95 95 96 205 205 94 146 146 147 205 205 147 148 205 148 149 149 97 205 149 150 97 150 98 97 151 206 153 152 206 150 153 206 152 101 206 151 99 206 101 100 206 99 100 98 206 206 98 150 101 207 102 103 207 104 102 207 103 151 207 101 155 207 151 154 207 155 156 207 154 104 207 156 104 208 106 105 208 107 106 208 105 156 208 104 157 208 156 158 208 157 159 208 158 107 208 159 108 107 160 160 107 159 161 209 163 162 209 160 163 209 162 111 209 161 109 209 111 110 209 109 108 209 110 160 209 108 16 113 164 17 16 164 113 112 164 164 112 165 112 111 165 165 111 161 164 1 17 165 1 164 161 1 165 161 216 1 163 216 161 157 216 163 156 216 157 119 216 156 154 119 156 154 118 119 155 118 154 151 118 155 151 213 118 211 213 153 153 213 151 152 211 153 150 211 152 149 211 150 148 211 149 147 211 148 146 211 147 146 212 211 118 213 212 212 213 211 157 162 158 157 163 162 159 162 160 158 162 159 117 212 146 118 212 117 144 117 146 145 117 144 141 117 145 215 117 141 215 141 143 143 137 215 137 136 215 215 136 210 136 134 210 210 134 135 131 115 135 214 131 133 133 132 214 132 128 214 129 128 130 130 128 132 138 137 142 142 137 143 140 138 142 139 138 140 135 115 210 210 115 116 210 116 215 116 117 215 214 115 131 126 114 214 124 114 126 125 114 124 121 114 125 54 121 55 54 114 121 128 127 214 127 126 214 55 121 123 123 122 55 122 120 48 55 122 48 214 114 115 1 216 119 220 221 199 59 217 65 65 217 66 59 218 217 224 225 72 66 217 60 188 218 59 60 218 188 219 224 71 219 223 198 219 222 121 125 220 121 199 221 124 124 221 125 123 222 198 121 222 123 198 223 69 69 223 71 71 224 72 72 225 73 73 225 199' >
        <Coordinate DEF="Body1_Coords" point='-0 40 3.5 -0 43 5 -0 24.6667 3.5 -0 32.3333 3.5 0 17 3.5 0 17 12.5 0 10 12.5 0 10 -4.16667 0 10 4.16667 0 10 -12.5 0 17 -12.5 0 17 -3.5 -0 32.3333 -3.5 -0 24.6667 -3.5 -0 40 -3.5 -0 43 -5 -0 50 -5 -0 50 5 -14.7224 8.5 -12.5 -8.5 14.7224 -12.5 -17 0 -12.5 -17 0 -3.5 -8.5 14.7224 -3.5 -14.7224 8.5 -3.5 -5 8.66025 -12.5 -8.66025 5 -12.5 -10 0 -12.5 -8.66025 5 12.5 -5 8.66025 12.5 -10 -0 12.5 -10 -0 4.16667 -10 -0 -4.16667 -8.5 14.7224 12.5 -14.7224 8.5 12.5 -17 -0 12.5 -14.7224 8.5 3.5 -8.5 14.7224 3.5 -17 -0 3.5 -38.9971 8.90084 3.5 -36.0388 17.3554 3.5 -31.2733 24.9396 3.5 -24.9396 31.2733 3.5 -17.3554 36.0388 3.5 -8.90084 38.9971 3.5 -40 -0 3.5 -32.3333 -0 3.5 -24.6667 -0 3.5 -59 -0 -5 -59 -0 5 -51 -0 -5 -43 0 -5 -40 -0 -3.5 -24.6667 -0 -3.5 -32.3333 -0 -3.5 -43 -0 5 -51 -0 5 -8.90084 38.9971 -3.5 -17.3554 36.0388 -3.5 -24.9396 31.2733 -3.5 -31.2733 24.9396 -3.5 -36.0388 17.3554 -3.5 -38.9971 8.90084 -3.5 -9.5684 41.9219 -5 -18.657 38.7417 -5 -26.8101 33.6188 -5 -33.6188 26.8101 -5 -38.7417 18.657 -5 -41.9219 9.5684 -5 -59 3 -5 -52.9077 4.70945 -5 -56.0065 4.04257 -5 -49.7503 4.99052 -5 -49.4409 7.45613 -5 -49.0094 9.90332 -5 -48.4569 12.3261 -5 -54.0116 15.3566 -5 -51.3277 13.6701 -5 -56.4679 17.3601 -5 -54.4158 22.9983 -5 -48.1062 22.5209 -5 -51.2463 22.9541 -5 -45.0432 21.7052 -5 -43.9091 23.9163 -5 -42.6667 26.0683 -5 -41.3188 28.1559 -5 -45.502 32.9035 -5 -43.5568 30.4007 -5 -47.125 35.6263 -5 -43.2683 40.2226 -5 -37.5024 37.616 -5 -40.305 39.0971 -5 -34.9031 35.8019 -5 -33.0812 37.4917 -5 -31.1777 39.089 -5 -29.1971 40.5898 -5 -31.5042 46.4818 -5 -30.5323 43.4647 -5 -32.0981 49.5955 -5 -26.9019 52.5955 -5 -22.3753 48.1741 -5 -24.5023 50.5244 -5 -20.5532 45.5803 -5 -18.2633 46.5452 -5 -15.9282 47.3951 -5 -13.5538 48.1279 -5 -13.7066 54.4537 -5 -13.8252 51.2861 -5 -13.1997 57.5827 -5 -7.29082 58.6246 -5 -4.54942 52.9217 -5 -5.74428 55.8577 -5 -3.72435 49.8611 -5 -2.48418 49.9383 -5 -1.24247 49.9846 -5 -41.9219 9.5684 5 -38.7417 18.657 5 -33.6188 26.8101 5 -26.8101 33.6188 5 -18.657 38.7417 5 -9.5684 41.9219 5 -59 3 5 -49.7503 4.99052 5 -56.0065 4.04257 5 -52.9077 4.70945 5 -49.0094 9.90332 5 -49.4409 7.45613 5 -48.4569 12.3261 5 -51.3277 13.6701 5 -54.0116 15.3566 5 -56.4679 17.3601 5 -54.4158 22.9983 5 -45.0432 21.7052 5 -51.2463 22.9541 5 -48.1062 22.5209 5 -42.6667 26.0683 5 -43.9091 23.9163 5 -41.3188 28.1559 5 -43.5568 30.4007 5 -45.502 32.9035 5 -47.125 35.6263 5 -43.2683 40.2226 5 -34.9031 35.8019 5 -40.305 39.0971 5 -37.5024 37.616 5 -31.1777 39.089 5 -33.0812 37.4917 5 -29.1971 40.5898 5 -30.5323 43.4647 5 -31.5042 46.4818 5 -32.0981 49.5955 5 -26.9019 52.5955 5 -20.5532 45.5803 5 -24.5023 50.5244 5 -22.3753 48.1741 5 -15.9282 47.3951 5 -18.2633 46.5452 5 -13.5538 48.1279 5 -13.8252 51.2861 5 -13.7066 54.4537 5 -13.1997 57.5827 5 -7.29082 58.6246 5 -3.72435 49.8611 5 -5.74428 55.8577 5 -4.54942 52.9217 5 -1.24247 49.9846 5 -2.48418 49.9383 5 -9.42726 9.42726 -12.5 -7.07107 7.07107 5.431 -7.07107 7.07107 -2.72279 -9.42726 9.42726 12.5 -11.3473 12.6586 8 -5.29046 16.1558 8 -9.03026 22.2333 3.5 -19.5289 19.5311 3.5 -27.6713 16.2332 3.5 -30.4793 8.52783 3.5 -22.2321 9.03207 3.5 -8.52691 30.4802 3.5 -16.2318 27.6723 3.5 -53.7686 -0 -0 -46.4147 -0 0 -16.8123 16.4271 -3.5 -23.9515 20.5185 -3.5 -7.07118 29.3911 -3.5 -14.6766 30.672 -3.5 -18.776 24.6661 -3.5 -5.61257 21.6332 -3.5 -12.0036 22.7876 -3.5 -28.8385 16.0517 -3.5 -22.3865 9.60819 -3.5 -30.5864 8.38568 -3.5 -35.9206 31.3112 -5 -24.4369 42.9703 -5 -25.2684 38.5446 -5 -38.5763 25.2655 -5 -7.35404 47.2387 -5 -46.3134 16.6953 -5 -27.3387 47.4064 -5 -54.4674 4.42374 0 -49.2404 8.68241 -0 -52.6956 14.472 0 -49.6696 22.7859 0 -43.3013 25 -0 -44.568 31.6222 0 -38.8809 38.3997 0 -31.0648 44.9583 -0 -23.4026 49.382 0 -17.101 46.9846 0 -13.8147 52.8717 0 -5.10163 54.4081 0 -38.5763 25.2655 5 -26.6465 45.9859 5 -24.8452 39.6151 5 -22.6399 42.4802 5 -46.3134 16.6953 5 -35.9206 31.3112 5 -7.35404 47.2387 5 -35.0075 21.7983 -4.25 -33.656 21.1475 -3.5 -49.7503 4.99052 0 -49.4954 6.83647 2.5 -49.3618 7.94025 3.02605 -52.1088 4.70713 2.5 -52.1088 4.70713 -2.5 -49.4954 6.83647 -2.5 -49.3618 7.94025 -3.02605'  />
      </IndexedTriangleSet>
    </Shape>

    <!-- Display usage message -->
    <Transform DEF="Nr">
      <DirectionalLight direction="0 0 -1" />
      <Transform translation="0 0.037 0.5" scale="0.2 0.2 0.2">
        <Shape>
          <Appearance>
            <Material diffuseColor="1 1 1" />
          </Appearance>
          <Text DEF="Text" string='"H3DPhysics Soft Body: Angular Joint (Soft-Rigid)"' solid="true">
            <FontStyle justify='"MIDDLE" "BEGIN"' size="0.015" spacing="1" />
          </Text>
        </Shape>
        <Transform translation="0 -0.02 0">
          <Shape>
            <Appearance>
              <Material diffuseColor="1 1 1" />
            </Appearance>
            <Text DEF="Text" string='"Press Y or Z to create a joint with axis Y or Z." "Press X to remove the joint."' solid="true">
              <FontStyle justify='"MIDDLE" "BEGIN"' size="0.01" spacing="1" />
            </Text>
          </Shape>
        </Transform>
      </Transform>
    </Transform>

    <PhysicsBodyCollection DEF='RBC' physicsEngine='Bullet' gravity='0 -1 0'>

      <BulletWorldOptions fixedTimeStep='0.005' />

      <!-- Geometries for collision detection -->
      <CollisionCollection containerField='collider'>
        <CollidableShape DEF='C' containerField='collidables'>
          <Shape USE='S' containerField='shape' />
        </CollidableShape>
        <CollidableShape DEF='C1' containerField='collidables'>
          <Shape USE='S1' containerField='shape' />
        </CollidableShape>
      </CollisionCollection>

      <!-- Rigid bodies for physics simulation -->
      <RigidBody DEF='R' autoDamp='true' linearDampingFactor='1' angularDampingFactor='0.001' mass='3' position='0 -0.3 0' fixed='true'>
        <CollidableShape USE='C' containerField='geometry' />
        <Box USE='G' containerField='massDensityModel' />
      </RigidBody>
      <RigidBody DEF='R1' autoDamp='true' linearDampingFactor='1' angularDampingFactor='0.001' mass='1' position='0.1 0.05 0'>
        <CollidableShape USE='C1' containerField='geometry' />
        <Box USE='G1' containerField='massDensityModel' />
      </RigidBody>

      <SoftBody DEF='SoftBody'>
        <BulletSoftBodyOptions nrClusters='32' />

        <MassSpringPhysicsMaterial>

          <UniformMass mass="1.0" />
          <UniformStiffness stiffness="1.0" />
          <UniformDamping damping="0.001" />
          <UniformFriction friction="0.1" />

        </MassSpringPhysicsMaterial>

        <IndexedTetraSet DEF='Body1_Tetra' index='210 194 202 136 191 84 203 86 198 47 179 48 215 203 204 191 39 66 60 67 38 44 180 51 143 142 203 137 140 139 203 138 190 38 175 61 203 89 86 90 178 58 41 184 72 224 67 225 142 140 204 138 85 88 204 90 48 55 179 122 180 51 50 67 180 219 121 220 146 193 94 212 192 206 205 211 49 71 69 223 214 200 201 196 196 75 200 80 38 53 51 61 179 68 198 70 39 67 38 114 175 60 190 61 194 66 202 82 36 35 181 22 215 116 194 65 214 128 200 127 191 59 40 65 75 78 201 80 214 66 115 114 190 60 175 188 38 39 175 60 124 114 125 221 203 86 85 90 203 142 204 138 215 137 203 136 203 143 204 142 203 140 204 139 204 203 215 143 142 138 203 137 203 85 204 90 204 143 215 141 215 194 210 136 48 122 179 120 215 143 203 137 202 135 210 134 204 140 203 138 204 87 140 88 210 136 202 134 201 133 214 131 214 201 200 132 214 133 201 132 67 72 71 224 55 122 123 222 175 38 190 45 40 116 215 65 190 53 38 61 55 219 179 222 51 61 50 67 39 116 210 115 39 174 188 218 196 66 214 67 39 217 210 218 180 121 54 220 210 217 40 218 166 23 168 22 182 174 189 173 180 71 49 219 171 167 8 28 49 219 71 223 214 132 200 128 200 132 201 128 201 129 200 128 132 130 201 128 130 129 201 128 180 55 54 121 196 74 200 76 214 127 200 126 200 75 201 80 49 70 179 223 202 66 131 81 200 75 196 76 202 115 131 66 40 174 182 173 179 70 198 223 144 93 146 193 179 122 55 222 199 114 124 221 191 40 215 65 4 172 186 36 189 174 176 173 47 120 198 68 210 194 215 116 171 167 170 36 203 87 204 88 47 48 198 120 35 23 30 21 190 45 38 53 121 219 55 222 38 45 44 53 44 51 38 53 38 60 175 61 119 0 43 216 194 191 215 65 123 122 198 222 175 60 39 188 126 124 199 114 38 51 180 61 40 217 59 218 40 174 39 218 168 23 35 22 179 219 49 223 175 189 190 188 35 33 37 30 123 121 55 222 180 50 49 71 198 48 179 120 179 122 198 120 199 219 114 220 67 219 199 224 201 129 130 77 39 60 38 67 39 40 210 116 39 115 210 217 179 47 198 68 201 79 196 80 180 61 51 67 135 131 202 115 210 135 202 115 60 61 38 67 180 49 179 219 60 217 39 218 188 174 59 218 131 115 214 66 210 40 39 218 59 174 40 218 176 52 189 21 200 129 201 77 179 49 47 70 47 68 179 70 114 219 180 220 54 114 180 220 67 73 199 74 126 67 199 74 200 196 214 74 214 126 200 74 214 67 126 74 196 67 214 74 196 79 201 81 131 66 214 81 204 139 140 87 201 131 214 81 214 196 201 81 214 66 196 81 201 77 130 78 204 85 203 88 203 139 204 87 201 75 200 77 66 81 202 82 196 200 201 80 75 77 201 78 204 89 203 90 38 115 39 114 194 82 202 83 194 83 202 84 202 136 194 84 215 191 194 84 194 136 215 84 203 191 215 84 215 136 203 84 85 87 203 88 146 94 205 212 214 67 66 114 199 67 126 114 126 67 214 114 191 203 204 89 191 86 203 89 211 212 205 213 42 117 118 212 191 89 204 91 215 191 204 91 204 141 215 91 151 207 118 213 41 193 117 212 125 114 121 220 179 219 198 222 121 114 54 220 115 66 39 114 66 67 39 114 198 122 179 222 180 44 38 114 180 54 44 114 156 119 154 207 39 188 60 218 185 58 178 184 181 36 173 35 186 172 187 22 2 186 4 172 18 26 31 20 31 21 18 20 57 62 56 63 40 41 182 58 215 40 191 41 56 183 177 184 7 168 8 36 30 23 31 21 172 36 187 22 181 172 173 36 170 32 169 28 7 11 10 22 37 33 34 30 189 176 181 173 8 171 4 36 7 24 168 22 176 35 37 21 167 33 35 27 41 64 117 193 194 66 65 217 2 13 11 186 7 8 4 36 18 23 166 22 166 25 168 23 186 172 2 183 152 206 153 211 195 1 111 216 169 167 170 28 189 35 176 23 181 173 176 35 31 23 18 21 39 66 115 217 168 25 31 23 40 173 182 41 41 42 178 184 167 35 168 30 57 58 41 193 190 189 175 176 167 28 169 27 2 11 4 186 67 114 199 219 189 188 175 174 185 173 178 41 145 92 144 64 5 171 6 32 181 176 189 35 175 52 176 46 206 211 192 213 59 182 40 174 182 181 185 173 94 193 192 212 35 23 181 22 179 55 180 219 178 173 187 172 190 52 175 46 187 178 185 173 175 176 189 174 189 181 182 173 199 73 67 225 4 8 5 171 185 181 187 173 18 25 166 23 187 173 181 172 8 167 171 36 110 105 106 208 175 188 39 174 187 172 181 36 188 182 59 174 189 182 188 174 170 36 167 35 192 212 193 213 41 117 42 212 42 57 56 184 62 103 63 207 171 32 170 28 5 8 6 171 93 94 146 193 167 36 168 35 45 53 190 52 175 45 190 46 35 30 37 21 63 212 118 213 168 25 166 24 6 32 171 28 189 176 190 52 169 33 167 27 193 212 63 213 45 52 190 46 13 186 2 183 168 167 8 36 187 36 181 22 34 30 33 29 4 11 7 22 186 36 172 22 7 36 4 22 168 24 166 22 168 35 36 22 33 29 30 27 4 186 11 22 205 211 146 212 31 30 168 23 176 46 52 21 35 30 167 27 190 176 175 52 170 167 171 28 168 36 7 22 33 30 35 27 182 173 185 41 170 33 169 32 159 162 158 208 166 22 24 19 31 25 18 23 168 30 35 23 4 36 186 22 104 103 62 207 117 64 144 193 42 118 119 207 176 37 46 21 187 172 186 183 181 35 189 23 185 178 187 184 189 23 176 21 176 23 35 21 170 167 169 33 170 35 167 33 6 171 8 28 31 26 18 25 18 22 166 19 24 22 7 19 7 22 10 19 7 10 9 19 9 24 7 19 104 208 156 216 109 106 195 209 144 64 93 193 146 117 144 193 119 118 154 207 40 59 191 58 178 177 187 184 41 58 191 64 194 65 116 217 215 116 40 117 192 193 63 213 41 58 57 184 191 41 40 58 161 111 165 1 92 93 144 64 195 104 62 216 41 57 42 184 111 209 195 216 141 91 145 64 150 206 97 98 144 117 145 64 205 212 192 213 205 192 96 197 43 177 56 3 57 64 58 193 40 41 215 117 187 177 172 183 185 41 178 58 40 182 59 58 195 209 208 216 63 64 57 193 177 183 187 184 191 58 65 64 13 183 2 12 205 94 96 192 118 207 63 213 191 91 215 64 91 92 145 64 182 41 185 58 59 65 191 58 42 177 178 184 178 172 187 177 177 183 56 12 42 57 41 193 158 162 157 208 192 211 205 213 205 206 149 211 41 118 42 117 2 183 177 3 172 177 2 183 57 193 42 212 109 195 111 209 159 107 160 208 161 209 111 216 149 148 205 211 145 117 141 64 215 41 191 64 215 117 41 64 215 91 141 64 141 117 215 64 56 195 43 0 111 1 161 216 195 0 1 216 57 63 42 207 62 104 156 216 42 56 43 184 56 177 43 184 43 177 42 184 95 97 205 197 56 12 14 0 197 99 100 206 56 3 12 0 43 3 56 0 103 102 63 207 117 193 146 212 43 195 62 216 202 66 194 217 150 206 152 211 62 119 43 216 119 1 43 0 107 105 110 208 154 118 155 207 42 63 118 207 58 64 41 193 14 195 56 0 110 106 109 209 205 96 95 197 63 101 192 213 195 208 104 216 15 1 195 0 156 104 62 207 97 206 197 98 62 14 15 195 15 195 14 0 40 65 59 217 202 194 210 217 56 62 43 195 56 14 62 195 162 163 157 209 62 119 156 207 156 119 62 216 108 208 110 209 160 208 108 209 162 208 160 209 110 208 106 209 106 208 195 209 197 206 100 98 183 12 177 3 108 107 110 208 43 0 195 216 160 162 159 208 149 206 150 211 94 192 205 212 148 147 205 211 16 113 15 1 192 99 197 206 43 119 62 207 177 12 56 3 205 197 97 206 2 12 183 3 157 208 162 209 156 208 157 216 42 119 43 207 62 63 57 207 102 101 63 207 155 118 151 207 164 16 17 1 192 197 205 206 160 107 108 208 205 147 146 211 63 193 57 212 42 193 41 212 165 112 164 1 205 97 149 206 97 150 149 206 116 65 40 217 42 63 57 212 101 99 192 206 1 0 119 216 118 63 42 212 106 104 195 208 56 57 42 207 56 62 57 207 43 56 42 207 43 62 56 207 63 207 101 213 101 207 151 213 151 206 101 213 101 206 192 213 153 206 151 213 153 211 206 213 164 113 16 1 60 66 39 217 111 195 15 1 165 111 112 1 112 111 15 1 164 112 113 1 113 112 15 1 208 209 157 216 157 209 163 216 163 209 161 216 210 115 202 217 115 66 202 217 67 71 50 224 210 116 40 217 194 116 210 217 55 121 180 219 198 70 69 223 199 220 114 221 198 219 179 223 114 220 125 221 69 70 49 223 38 114 67 219 180 114 38 219 50 71 180 224 67 73 72 225 38 61 180 219 38 67 61 219 61 67 180 219 67 224 199 225 71 219 180 224 180 67 50 224 180 219 67 224' >
          <Coordinate USE="Body1_Coords"  />
        </IndexedTetraSet>
        <IndexedTriangleSet USE="Body1_Surface" containerField='surfaceGeometry' />
      </SoftBody>

      <FunctionSoftBodyModifier>
        <SoftBody USE='SoftBody' containerField='body1' />
        <GaussianFunction amplitude='0.01' width='0.05' containerField='distanceToForce' />
      </FunctionSoftBodyModifier>

    </PhysicsBodyCollection>

    <KeySensor DEF='KS' />

    <PythonScript url='GetTransforms.py' moduleName='GetTransforms' />
    <PythonScript url='SoftBodyAngularJoint_Rigid.py'>
      <SoftBody USE='SoftBody' containerField='references' />
      <RigidBody USE='R1' containerField='references' />
      <PhysicsBodyCollection USE='RBC' containerField='references' />
      <KeySensor USE='KS' containerField='references' />
    </PythonScript>

    <ROUTE fromNode='R' fromField='position' toNode='T' toField='translation' />
    <ROUTE fromNode='R' fromField='orientation' toNode='T' toField='rotation' />

    <ROUTE fromNode='R1' fromField='position' toNode='T1' toField='translation' />
    <ROUTE fromNode='R1' fromField='orientation' toNode='T1' toField='rotation' />

    <!-- Update title text message position -->
    <ROUTE fromNode="V" fromField="totalPosition" toNode="PS" toField="textPos" />
    <ROUTE fromNode="V" fromField="totalOrientation" toNode="PS" toField="textPos" />
    <ROUTE fromNode="PS" fromField="textPos" toNode="Nr" toField="translation" />
    <ROUTE fromNode="V" fromField="totalOrientation" toNode="Nr" toField="rotation" />

  </Scene>
</X3D>
